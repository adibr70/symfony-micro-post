{#
/**
 * @file
 * Template for page that list all the articles
 *
 * Available variables (needed for the test):
 * - data_t2: The variable for the block solution_news. This variable contains a list
 *   of articles from a JSON format that needs to be rendered as requested.
 *   Each item inside data_t2 contains the following content:
 *   - id: the id of the article.
 *   - date: the date of the article.
 *   - title: the title of the article.
 *   - slug: the slug used for the url.
 *   - location: where rhe article happened.
 *   - text: long text with the HTML of the article.
 *   - images: array of images. Can be empty.
 *
 * Other variables availables:
 * - num_articles: The number of articles loaded and available in data_t2.
 * And any other variable from the parent templates.
 */
#}
{% extends 'base.twig' %}

{% block content %}
    <h1 class="mt-3">ESN Articles</h1>

    <div class="container">

        {% if num_articles is not divisible by (3) %}
            {% set rows = num_articles // 3 %}
        {% else %}
            {% set rows = num_articles / 3 - 1 %}
        {% endif %}

        {% for i in 0..rows %}
            <div class="row">
                {% for d_t2 in data_t2|reverse|slice(i*3, 3) %}
                    <div class="col-sm-4">
                        <div class="card" style="width: 18rem;">

                            {% if d_t2.images[0] is not empty %}
                                <img class="card-img-top" src="{{ d_t2.images[0]|first }}" alt="{{d_t2.location}}">
                            {% else %}
                                <img class="card-img-top" src="https://via.placeholder.com/800x600/000000/999DAO?text=TestImage1">
                            {% endif %}

                            <div class="card-body">
                                <h5 class="card-title">{{ d_t2.title }}</h5>

                                <div class="clearfix">
                                    <p class="float-sm-right text-muted">{{ d_t2.date }}</p>
                                </div>

                                <p class="card-text">
                                    {% set text = d_t2.text|striptags %}
                                    {{ text|length > 250 ? text|slice(0, 250) ~ '...' : text }}
                                </p>

                                <a href="{{ site_url}}/article/{{ d_t2.slug }}" class="btn btn-primary">Go to the article</a>
                            </div>

                        </div>
                    </div>
                {% endfor %}
            </div>
            {% if i != rows %}
                <hr class="separation">
            {% endif %}
        {% endfor %}

    </div>
{% endblock %}